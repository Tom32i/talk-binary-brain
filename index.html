<!doctype html>
<html>
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

        <title>The Binary Brain</title>

        <link rel="stylesheet" href="./node_modules/reveal.js/css/reveal.css">
        <link rel="stylesheet" href="./node_modules/reveal.js/css/theme/beige.css">

        <!-- Theme used for syntax highlighting of code -->
        <link rel="stylesheet" href="./node_modules/reveal.js/lib/css/zenburn.css">

        <style type="text/css">
            .reveal section .none {
                border: none;
                background: none;
                box-shadow: none;
            }

            .reveal section .ipad {
                border: 1em solid black;
                border-left-width: 2em;
                border-right-width: 2em;
                background: #333333;
                box-shadow: none;
                border-radius: 1em;
                overflow: visible;
                padding: 0em;
                width: 20em;
                height: 15em;
                margin: 1em auto 0;
                box-shadow: 0 0.1em 0 0 #333333;
            }

            .reveal section .ipad img {
                margin: 0;
                width: 100%;
                height: auto;
                max-width: 100%;
                max-height: 100%;
            }

            .reveal section code.multiligne {
                word-wrap: break-word;
            }

            .reveal section .blocks {
                display: block;
                font-size: 0.7em;
                letter-spacing: -2px;
                font-family: monospace;
            }

            .reveal section .blocks .block {
                display: inline-block;
                margin: 0 5px;
            }

            .reveal section .emoji {
                font-size: 2em;
            }

            .reveal section .pixel {
                width: 2em;
                height: 2em;
                display: inline-block;
            }

            .reveal section .pixel-big {
                width: 4em;
                height: 4em;
                display: inline-block;
            }

            .reveal section .mutted {
                color: #888888;
            }

            .reveal section .center {
                text-align: center;
            }

            /*.reveal section iframe {
                position: absolute;
                z-index: 10;
            }*/

            .reveal section .badge {
                color: white;
                background-color: #5dbab6;
                padding: 0px 8px;
                font-family: monospace;
                font-size: 0.8em;
                border-radius: 4px;
            }

            .reveal section .row {
                display: flex;
            }

            .reveal section .row .column {
                flex: 1;
                text-align: center;
            }

            .reveal section .marquee {
                overflow: hidden;
                position: absolute;
                height: 2em;
                width: 250%;
                margin-left: -75%;
            }

            .reveal section .url {
                color: white;
                letter-spacing: 0.2em;
            }

            .reveal section .red { color: red; }
            .reveal section .green { color: green; }
            .reveal section .blue { color: blue; }

            .reveal section .marquee > * {
                position: absolute;
                width: 100%;
                height: 100%;
                margin: 0;
                padding: 0;
                text-align: center;
                transform:translateX(100%);
                animation: marquee 20s linear infinite;
                letter-spacing: 5px;
                font-family: monospace;
            }

            @keyframes marquee {
                from { transform: translateX(0%); }
                to { transform: translateX(-100%); }
            }
        </style>
        <meta but-du-talk="Monter que manipuler des donn√©es binaire en JS c'est √† port√©e de main.">
    </head>
    <body>
        <div class="reveal">
            <div class="slides">
                <section data-background="#000000">
                    <h1 style="text-shadow: none; color: white;">The Binary Brain</h1>
                    <img class="none" src="./img/intro.jpg">
                </section>
                <section>
                    <section>
                        <h2>Thomas, Web Developer.</h2>
                    </section>
                </section>
                <section>
                    <section data-background="#5dbab6" style="color: white;">
                        <h2 style="color: white;">SPINE</h2>
                        <p>Universit√© de Bordeaux<br/>&times;<br/>Harvard Medical School</p>
                        <!-- Besoins du serious game: dessiner dans le cerveau humain -->
                        <!-- Crowdsourcer la recherche en neurologie -->
                    </section>
                    <section data-background="#5dbab6" style="color: white;">
                        <quote>Analyser des IRM du cerveau<br/>par le grand public sur tablette</quote>
                        <div class="ipad"><img class="none" src="./img/spine-game.png"></div>
                    </section>
                    <section data-background="./img/spine-1.jpg">
                        <!--h2 style="color: white; text-shadow: 0 0 5px black;">#SeriousGame</h2-->
                    </section>
                    <section data-background="./img/spine-2.jpg">
                        <!--h2 style="color: white; text-shadow: 0 0 5px black;">#Crowdsourcing</h2-->
                    </section>
                    <section data-background="./img/spine-3.jpg">
                        <!--h2 style="color: white; text-shadow: 0 0 5px black;">#Recherche</h2-->
                    </section>
                    <!--section data-background="#5dbab6" style="color: white;">
                        <div class="ipad" style="font-size: 32px; margin-top: 0em;">
                            <img class="none" src="./img/spine-in-game-2.png">
                        </div>
                    </section-->
                </section>
                <section>
                    <section>
                        <h2>IRM</h2>
                        <small>Imagerie par R√©sonance Magn√©tique</small>
                    </section>
                    <section data-background="./img/IRM.jpg"></section>
                    <section data-background="./img/IRM_result.jpg"></section>
                    <section>
                        <h2>Image Voxel</h2>
                        <img class="none" src="./img/minecraft.png" style="max-height: 500px;">
                        <!-- CSS 3D grid? -->
                    </section>
                    <section>
                        <span class="emoji">üíæ</span>
                        <p>my_brain.nii<br/><span class="mutted">Nifti-1</span></p>
                        <!-- Knight of ni -->
                    </section>
                    <section>
                        <quote>In web we trust</quote>
                    </section>
                    <section>
                        <h2><span class="emoji">ü§ñ</span></h2>
                        <div class="marquee"><p id="binary"></p></div>
                        <!-- Animation binaire qui se remplie ? -->
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Le binaire</h2>
                    </section>
                    <section>
                        <h3 style="letter-spacing: 10px;">1<span class="mutted">,</span>  10<span class="mutted">,</span>  11<span class="mutted">,</span>  100<span class="mutted">,</span>  101</h3>
                    </section>
                    <section>
                        <h3 class="">1 bit <span class="mutted"> = </span> 0 <span class="mutted">|</span> 1</h3>
                        <h3 class="fragment">8 bits <span class="mutted">=</span> 1 octet <span class="mutted">=</span> 10010110</h3>
                        <!--h3 class="fragment">1 GoT <span class="mutted">=</span> 536,870,912 octets</h3-->
                        <h3 class="fragment">1024 octets <span class="mutted">=</span>1 Ko <span class="mutted">=</span> 8192 bits</h3>
                    </section>
                    <section data-background="./img/GOT.jpg">
                        <h3 style="color: white;">536,870,912 octets</h3>
                    </section>
                </section>
                <section>
                    <section data-background="./img/binary_wall.jpg">
                        <h2 class="fragment" style="color: white;">Representer l'information</h2>
                    </section>
                    <section>
                        <h3>Num√©riser votre information</h3>
                        <p class="fragment">
                            1 infos => 1 nombre
                            <img class="none" src="./img/matrix.jpg">
                        </p>
                    </section>
                    <section data-background="#222222" style="color: white;">
                        <h3 style="color: white;">Num√©ro de s√©curit√© sociale</h3>
                        <p>
                            <span class="fragment highlight-red">1</span><span class="fragment highlight-blue">89</span><span class="fragment highlight-green">10</span><span class="fragment highlight-red">38</span><span class="fragment highlight-blue">185</span><span class="fragment highlight-green">048</span><span class="fragment highlight-red">86</span>
                        </p>
                    </section>
                    <section>
                        <h3>Stocker les nombres en binaire</h3>
                        <p>base 10 => base 2</p>
                    </section>
                    <section>
                       <h3>Repr√©senter une image en binaire</h3>
                    </section>
                    <section>
                        <div class="row" style="align-items: center; justify-content: space-around;">
                           <img class="column none" style="flex: 1;"" src="./img/doomguy.jpg">
                           <div class="column" style="flex: 3;">
                               <ul style="text-align: left;">
                                    <li class="fragment">Une grille de pixel</li>
                                    <li class="fragment">1 pixel = 1 couleur</li>
                                    <li class="fragment">1 couleur = 3 valeurs <span class="red">R</span><span class="green">V</span><span class="blue">B</span></li>
                                    <li class="fragment">1 valeur = 1 entier de 0 √† 255</li>
                                </ul>
                            </div>
                       </div>
                    </section>
                    <section>
                        <h3>Entier sur 8 bit</h3>
                        <p>00000000 = 0</p>
                        <p>11111111 = 255</p>
                        <p class="fragment">256 valeurs possibles</p>
                    </section>
                    <section>
                        <p>3 x 8 bits = 24 bits<br/>16,777,216 valeurs possibles</p>
                        <img class="none fragment" src="./img/windows_24bit.gif">
                    </section>
                    <!--section>
                        <h3>1 bit pour 1 entier sign√©:</h3>
                        <p>0 0000000 = -128</p>
                        <p>1 1111111 = +127</p>
                    </section-->
                    <section data-background="#222222" style="color: white;">
                        <!-- Une donn√©e binaire n'a pas de format a priori -->
                        <!-- example d'un fichier lisible dans plusieurs format ?! -->
                        <code style="font-size: 0.8em;">
                            <span class="fragment highlight-red">00110010</span><span class="fragment highlight-green">01000101</span><span class="fragment highlight-blue">00000101</span><span class="fragment highlight-red">01001110</span><span class="fragment highlight-green">01010110</span><span class="fragment highlight-blue">10101011</span>
                        </code>
                        <!-- Ici plutot ne faire que des paquet de 1 octet, exemple de 2 pixel RVB. -->
                        <p class="fragment">
                            <span class="fragment highlight-red">50</span><span class="fragment highlight-green">69</span><span class="fragment highlight-blue">5</span><span class="fragment highlight-red">78</span><span class="fragment highlight-green">86</span><span class="fragment highlight-blue">171</span>
                        </p>
                        <p class="fragment">
                            <span class="pixel" style="background-color: rgb(50, 69, 5);"></span>
                            <span class="pixel" style="background-color: rgb(78, 86, 171);"></span>
                        </p>
                    </section>
                    <section>
                        <h3>Entier sur 16 bit</h3>
                        <p>0000000000000000 = 0</p>
                        <p>1111111111111111 = 65535</p>
                        <p class="fragment">65 536 valeurs possibles</p>
                    </section>
                    <section data-background="#222222" style="color: white;">
                        <!-- Une donn√©e binaire n'a pas de format a priori -->
                        <!-- example d'un fichier lisible dans plusieurs format ?! -->
                        <code style="font-size: 0.8em;">
                            <span class="fragment highlight-red">0011001001000101</span><span class="fragment highlight-green">0000010101001110</span><span class="fragment highlight-blue">0101011010101011</span>
                        </code>
                        <!-- Ici plutot ne faire que des paquet de 1 octet, exemple de 2 pixel RVB. -->
                        <p class="fragment">
                            <span class="fragment highlight-red">12869</span><span class="fragment highlight-green">1358</span><span class="fragment highlight-blue">22187</span>
                        </p>
                        <p class="fragment">
                            <span class="pixel-big" style="background-color: rgb(50, 5, 86);"></span>
                        </p>
                    </section>
                    <!-- Ici reprendre l'exemple pr√©c√©dent mais avex 1 seul pixel encod√© en 16 bit. -->
                    <section>
                        <quote>Une chaine binaire n'a pas de signification en soit.<!--<br/>Il faut connaitre son format pour savoir quelle informations elle contient et o√π celles-ci se situent dans la chaine.--></quote>
                    </section>
                    <section data-background="./img/adn.jpg">
                        <!--p class="fragment">1 bit -> 1 nucl√©otide (base 4 ad√©nine (A), la thymine (T), la cytosine (C) et la guanine (G).</p-->
                    </section>
                </section>
                <section>
                    <section>
                        <h2>Manipuler du binaire<br/>en Javascript</h2>
                    </section>
                    <section>
                        <h3>ArrayBuffer</h3>
<pre><code class="hljs js center">const buffer = new ArrayBuffer(byteLength)</code></pre>
                        <p class="blocks fragment">
                            <span class="block">001100100100010100000101010011100101011010101011</span>
                        </p>
                    </section>
                    <section>
                        <h3>TypedArrays</h3>
<pre><code class="hljs js center">const view = new Uint8Array(buffer)</code></pre>
                        <p class="blocks fragment">
                            <span class="block">00110010</span>
                            <span class="block">01000101</span>
                            <span class="block">00000101</span>
                            <span class="block">01001110</span>
                            <span class="block">01010110</span>
                            <span class="block">10101011</span>
                        </p>
<pre class="fragment"><code class="hljs js center">[50, 69, 5, 78, 86, 171]</code></pre>
<!--pre class="fragment"><code class="hljs js">view[2] = 50;</code></pre-->
                    </section>
                    <section>
<pre><code class="hljs js center">const view = new Uint16Array(buffer)</code></pre>
                        <p class="blocks fragment">
                            <span class="block">0011001001000101</span>
                            <span class="block">0000010101001110</span>
                            <span class="block">0101011010101011</span>
                        </p>
<pre class="fragment"><code class="hljs js center">[12869, 1358, 22187]</code></pre>
                    </section>
                    <section>
                        <h3>Ecriture</h3>
<pre><code class="hljs js center">view[0] = 255;</code></pre>
                        <p class="blocks fragment">
                            <span class="block fragment highlight-red">11111111</span>
                            <span class="block">01000101</span>
                            <span class="block">00000101</span>
                            <span class="block">01001110</span>
                            <span class="block">01010110</span>
                            <span class="block">10101011</span>
                        </p>
                    </section>
                    <section>
                        <h3>Attention au d√©passements !</h3>
<pre><code class="hljs js center">view[0] = 546;</code></pre>
                        <p>546 = 10<span class="fragment highlight-red">00100010</span></p>
<pre class="fragment"><code class="hljs js center">view[0] === 34;</code></pre>
                    </section>
                    <section data-background="./img/pacman_int_overflow.jpg"></section>
                    <section>
                        <h3>Plein d'utilitaires!</h3>
                        <pre class="fragment"><code class="hljs js center">Int8Array, Float32Array, Uint8ClampedArray, Uint32Array, ...</code></pre>
                        <pre class="fragment"><code class="hljs js center">new Uint8Array(buffer, 2, 4);</code></pre>
                        <!--pre class="fragment"><code class="hljs js center">new DataView(buffer).setInt16(42, 1337);</code></pre-->
                        <pre class="fragment"><code class="hljs js center">ArrayBuffer.slice(0, 352);</code></pre>
                    </section>
                    <!--section data-background="./img/troll.jpg">
                        <h3 style="color: white;">Tableaux typ√©s en PHP ?!</h3>
                        <pre><code class="hljs php center">$binary = pack("C*", 12, 255);
$values = unpack("C*", $binary);</code></pre>
                    </section-->
                </section>
                <section>
                    <section>
                        <h3>Recevoir des donn√©es existantes</h3>
                    </section>
                    <section>
                        <a href="https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest">XMLHttpRequest</a>
<pre><code class="hljs js">const request = new XMLHttpRequest();
request.responseType = 'arraybuffer';
request.open('GET', 'http://my.brain.com/my_brain.nii');
request.addEventListener('load', () => {
    const buffer = request.response;
});
request.send();</code></pre>
                    </section>
                    <section>
                        <a href="https://developer.mozilla.org/en/docs/Web/API/FileReader">FileReader</a>
<pre><code class="hljs js">const file = document.getElementById('my-file').files[0];
const buffer = new FileReader().readAsArrayBuffer(file);</code></pre>
                    </section>
                    <section>
                        <a href="https://developer.mozilla.org/en/docs/Web/API/FileReader">WebSocket</a>
<pre><code class="hljs js">const socket = new WebSocket('ws://localhost');
socket.binaryType = 'arraybuffer';
socket.send(buffer);
// ---
socket.on('message', (event) => { const buffer = event.data; })</code></pre>
                    </section>
                </section>
                <section>
                    <section>
                        <h2>La spec Nifti-1</h2>
                    </section>
                    <section>
                        <h3>Header sur 352 octets</h3>
                        <table>
                            <tbody>
                                <tr class="fragment">
                                    <td><span class="badge">40</span></td>
                                    <td>Nombre de dimensions: 3 (ou 4 üëΩ)</td>
                                </tr>
                                <tr class="fragment">
                                    <td>
                                        <span class="badge">42</span>
                                        <span class="badge">44</span>
                                        <span class="badge">46</span>
                                    </td>
                                    <td>Largeur, hauteur et profondeur</td>
                                </tr>
                                <tr class="fragment">
                                    <td>
                                        <span class="badge">70</span>
                                        <span class="badge">72</span>
                                    </td>
                                    <td>DataType et Nombre de bit par voxel</td>
                                </tr>
                                <tr class="fragment">
                                    <td><span class="badge">...</span></td>
                                    <td>Information d'√©chelles, description, etc.</td>
                                </tr>
                            </tbody>
                        </table>
                    </section>
                    <section>
                        <h4>Manipuler le header</h4>
<pre><code class="hljs js">const header = new DataView(buffer, 0, 352);
const width  = header.getUint16(42); // 256
const height = header.getUint16(44); // 256
const depth  = header.getUint16(46); // 176
const dataType = header.getUint16(70); // 16 (Float32Array)
const bitPerVoxel = header.getUint16(72); // 32</code></pre>
                    </section>
                    <section>
                        <h3>Body √† partir de l'octet 352</h3>
                        <p>Suite de voxel o√π 1 voxel = 1 entier.</p>
                    </section>
                    <section>
                        <pre><code class="hljs js">const size = 352 + (length * width * depth) * (bitPerVoxel / 8);</code></pre>
                        <p>46 137 696 octets</p>
                        <p>46,1 Mo</p>
                    </section>
                    <section>
                        <h4>Manipuler le body</h4>
                        <pre><code class="hljs js center">const body = new Float32Array(buffer, 352); </code></pre>
                        <!-- Analogie du livre:
                        soit un livre dont chaque ligne contient le m√™me nombre de mot et chaque page le m√™me nombre de ligne.
                        Le 3√®me mot de la ligne 5 de la page 127;
                        const mot = numero + ligne * motParLigne + page * motParPage;
                        motParPage = motParPage * ligneParPage;
                        -->
                    </section>
                    <!--section data-state="demo-end">
                        <p>O√π se trouve l'information ?</p>
                        <pre><code class="hljs js">function getIndex(x, y, z) {
    return x + y * width + z * (width * height);
}</code></pre>
                        <p style="font-size: 0.75em;">numero + ligne &times; motParLigne + page &times; (motParLigne &times; ligneParPage)</p>
                        <!- -pre class="fragment none center">[0,0,0][1,0,0][2,0,0]
[0,1,0][1,1,0][2,1,0]
[0,2,0][1,2,0][2,2,0]

[0,0,1][1,0,1][2,0,1]
[0,1,1][1,1,1][2,1,1]
[0,2,1][1,2,1][2,2,1]

[0,0,2][1,0,2][2,0,2]
[0,1,2][1,1,2][2,1,2]
[0,2,2][1,2,2][2,2,2]</pre- ->
                    </section-->
                    <section data-background-iframe="./demo" data-state="demo">
                        <span class="fragment"></span>
                        <a class="fragment url" href="https://lab.tom32i.fr/binary-brain/demo/" target="_blank">
                           lab.tom32i.fr/binary-brain/demo
                        </a>
                    </section>
                    <!--section>
                        Explication lecture ?
                        - read buffer
                        - Dataview: get info du header
                        - UintArray: body
                        - Calcul de la slice
                        - Cr√©ation de l'image
                    </section-->
                    <!--section>
                        Explication √©criture ?
                        - create buffer
                        - Dataview: set info du header
                        - UintArray: body
                        - Calcul de la slice
                        - Cr√©ation de l'image
                    </section-->
                    <!--section>
                        Demo dans slicer ?
                    </section-->
                </section>
                <section data-state="demo-end">
                    <section>
                        <h2>Pourquoi c'est cool ?</h2>
                    </section>
                    <section>
                        <h2 class="emoji">üèãÔ∏è</h2>
                        <h3>Le poids</h3>

                        <div>
                            <h4>Json: <small style="vertical-align: middle;">54 octets (54 caract√®re)</small></h4>
                            <pre><code class="hjs json">{ "event": "position", "id": 19, "x": 125, "y": 158 }</code></pre>
                        </div>

                        <div class="fragment">
                            <h4>Binaire: <small style="vertical-align: middle;">6 octets (1 + 1 + 2 + 2)</small></h4>
                            <pre><code class="hjs">[event sur 1 octet][id sur 1 octet][x sur 2 octets][y sur 2 octets]</code></pre>
                        </div>
                    </section>
                    <section>
                        <h2 class="emoji">‚ö°Ô∏è</h2>
                        <h3>Rapidit√© de l'encodage / d√©codage</h3>
                    </section>
                    <section>
                        <h2 class="emoji">üåç</h2>
                        <h3>Supporte tout, support√© partout.</h3>
                    </section>
                </section>
                <section>
                    <section>
                        <h2 class="emoji">‚ò†Ô∏è</h2>
                        <h2>Pourquoi c'est chaud ?</h2>
                        <ul>
                            <li class="fragment">Pas lisible</li>
                            <li class="fragment">Rigide</li>
                            <li class="fragment">Peu de bug</li>
                        </ul>
                    </section>
                    <section>
                        <h2 class="emoji">üí°Ô∏è</h2>
                        <h3>Quelques id√©es d'utilisation</h3>
                        <ul>
                            <li class="fragment">Lire et √©crire un format tiers.</li>
                            <li class="fragment">Jeu en temps r√©el.</li>
                            <li class="fragment">Filtres Instagram.</li>
                        </ul>
                    </section>
                    <section>
                        <quote>Javascript g√®re bien le binaire üëå</quote>
                    </section>
                </section>
                <section>
                    <h1>Merci !</h1>
                    <div class="row">
                        <div class="column">
                            <h4>Sources</h4>
                            <p><a href="https://nifti.nimh.nih.gov/nifti-1/documentation/nifti1fields">Specfication nitfi-1</a></p>
                            <p><a href="https://github.com/Tom32i/binary-brain">Tom32i/binary-brain</a></p>
                        </div>
                        <div class="column">
                            <h4>Questions ?</h4>
                            <p><a href="https://twitter.com/SPINEscience">@Spine</a></p>
                            <p><a href="https://twitter.com/Tom32i">@Tom32i</a></p>
                        </div>
                    </div>
                </section>
            </div>
        </div>

        <script src="./node_modules/reveal.js/lib/js/head.min.js"></script>
        <script src="./node_modules/reveal.js/js/reveal.js"></script>

        <script>
            Reveal.initialize({
                history: true,
                overview: false,
                help: false,

                dependencies: [
                    { src: './node_modules/reveal.js/plugin/markdown/marked.js' },
                    { src: './node_modules/reveal.js/plugin/markdown/markdown.js' },
                    { src: './node_modules/reveal.js/plugin/highlight/highlight.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } }
                ]
            });

            function setDemo(demo) {
                Reveal.addEventListener('demo', (e) => {
                    demo.navigator.stop();
                    Reveal.addEventListener('fragmentshown', demo.navigator.start);
                });
                Reveal.addEventListener('demo-end', (e) => {
                    Reveal.removeEventListener('fragmentshown', demo.navigator.start);
                    demo.navigator.stop();
                });
            }

            getRandomBinary(document.getElementById('binary'));

            function getRandomBinary(element, length = 256) {
                while (element.innerText.length < length) {
                    element.innerText += Math.random() > 0.5 ? 0 : 1;
                }
            }
        </script>
    </body>
</html>
